language: node_js
node_js:
- '0.10'
before_install:
- npm install -g npm@next
- npm install -g grunt-cli
install: npm install
before_deploy:
- grunt build
- grunt zip
- grunt codedeploy
deploy:
- provider: s3
  access_key_id: AKIAIMTOX4BXGVFOB56Q
  secret_access_key:
    secure: cDHIJcZitAo/mW4o91W4Npf+sPmQSnoAnHkaQeOX4EjwRTBXeKEzgnp6qUep0pUKgEVmjApKDwhcrUyrB6G4z9Yy/PM6XzdbHKRww41BzTn8ClcgbnJ62EJk5pTnnZmS/2oF8B31naXpcohaxCV1SYyXnyDIPslzRPJK7SlUmMI=
  skip_cleanup: true
  bucket: hmda-pilot
  local_dir: dist
  upload-dir: develop
  on:
    all_branches: true
- provider: codedeploy
  access_key_id: AKIAIMTOX4BXGVFOB56Q
  secret_access_key:
    secure: cDHIJcZitAo/mW4o91W4Npf+sPmQSnoAnHkaQeOX4EjwRTBXeKEzgnp6qUep0pUKgEVmjApKDwhcrUyrB6G4z9Yy/PM6XzdbHKRww41BzTn8ClcgbnJ62EJk5pTnnZmS/2oF8B31naXpcohaxCV1SYyXnyDIPslzRPJK7SlUmMI=
  bucket: hmda-pilot
  key: develop/hmda-pilot-codedeploy.zip
  application: hmda-pilot
  deployment_group: hmda-pilot-dev
  on:
    all_branches: true
- provider: s3
  access_key_id: AKIAIMTOX4BXGVFOB56Q
  secret_access_key:
    secure: cDHIJcZitAo/mW4o91W4Npf+sPmQSnoAnHkaQeOX4EjwRTBXeKEzgnp6qUep0pUKgEVmjApKDwhcrUyrB6G4z9Yy/PM6XzdbHKRww41BzTn8ClcgbnJ62EJk5pTnnZmS/2oF8B31naXpcohaxCV1SYyXnyDIPslzRPJK7SlUmMI=
  skip_cleanup: true
  bucket: hmda-pilot
  local_dir: dist
  upload-dir: master
  on:
    branch: master
- provider: codedeploy
  access_key_id: AKIAIMTOX4BXGVFOB56Q
  secret_access_key:
    secure: cDHIJcZitAo/mW4o91W4Npf+sPmQSnoAnHkaQeOX4EjwRTBXeKEzgnp6qUep0pUKgEVmjApKDwhcrUyrB6G4z9Yy/PM6XzdbHKRww41BzTn8ClcgbnJ62EJk5pTnnZmS/2oF8B31naXpcohaxCV1SYyXnyDIPslzRPJK7SlUmMI=
  bucket: hmda-pilot
  key: master/hmda-pilot-codedeploy.zip
  application: hmda-pilot
  deployment_group: hmda-pilot-prod
  on:
    branch: master
